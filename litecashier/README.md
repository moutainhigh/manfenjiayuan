满分POS
======


##TODO
3. 功能区添加广告icon。
8. 统一页面样式风格。
9. 打开软键盘切换到数字输入然后按下隐藏，再按下外接数字键盘，会连续输入两个数字。
1. pos订单条码是本地生成的，后台订单编号是后台生成的。两个不一样。
3. 优化 混淆代码，精简APK大小。
4. java.lang.RuntimeException: 序列已经达到最大值,不能生成新的序列!
5. 精简数据结构，合并相似的数据结构。
6. 赊账支付功能需要先登录。
8. 退货修改商品价格。
10. 日结是否需要锁定结算，退单，洗衣等功能。
11. 新增 应用运行日志记录，保存最近15天的运行日志，保存在sd卡中。
12. 支付记录信息重构。
13. 优化翻页数据加载和缓存策略。
14. 优化 数据同步策略。下载缓存数据。
15. 重构日结页面，MVC.
16. 统一归类api，账户，收银，等等。
17. 同步商品库：本地商品库数和可以同步的商品数不一致。
18. 优化列表加载策略，缓存数据，只下载更新部分。
19. /getByBarcode 未查到商品时返回null.
20. 办卡完成后需要提示办卡成功。
21. 充值页面输入手机号后显示加载提示。
22. 输入采购量时提示起配量。

@张永智 采购商品页面（http://www.manfenjiayuan.cn/pmc/scGoodsSku/findStoreWithChainSku?barcode=6902083880781&JSESSIONID=e3dcc212-c34a-4037-b9fc-48a54a757887&categoryId=&rows=30&page=-1&nameLike=）查询到的商品tenantSkuId为null。 导致加入采购商品购物车后和从库存成本入口采购商品不一致。

    

#v1.20.9_0229242
1. 修复 库存成本商品加入购物车失败的问题。
2. 新增 新建采购收货单成功后立刻弹出支付窗口功能。
3. 新增 选择批发商/门店作为发货方or收货方功能，且发货方/收货方为必选项。
4. 优化 切换登录帐号后，清空购物车中的商品。


#v1.20.9_0229241
1. 优化 商品采购功能。
2. 新增 会员卡开卡验证码功能。


#v1.20.9_0229240
1. 新增 会员卡支付功能。
2. 新增 会员卡开卡功能。


#v1.20.8_0229239
1. 数据重构&amp;优化。


##v1.20.7_0229238

1. 新增 在设置中查看本地商品库功能。
2. 重构 商品采购功能。
3. 修复 部分页面输入键盘数字键回车按键无反应问题。
4. 优化 其他体验优化。


##v1.20.7_0229237

1. 修复 退单商品支付方式为空的问题。
2. 修复 未支付完成状态的订单同步到后台的问题。
3. 新增 每次增量同步商品库结束后检查pos机商品数和后台sku商品数是否一致，如果不一致则下一次同步时自动触发全量同步。
4. 优化 同步商品库时条码为null的商品也会保存到本地数据库中，保证pos机本地数据商品数和后台sku商品数一致。


##v1.20.6_0229236
* 1 修复 零点定时检查日结失败的问题。
* 2 优化 收银支付流程。
* 3.新增 保存最近15天的运行日志。
* 
##v1.20.4_0222235
* 1 修复 第二天开机自动日结日期不正确的问题。
* 2 优化 日结功能。

##v1.20.3_0222234
#####1.日结功能
1. 新增 每天00:01自动检查是否需要日结功能。
2. 新增 日结确认接口添加outTradeNo参数。
3. 新增 查看本地日结记录功能（设置－日结）。	
4. 新增 小票毛利率显示。
5. 优化 删除流水分析数据中的线上订单支付显示。
#####2.优化 调整洗衣订单逻辑，增加不能挂单限制条件。
#####3.重构 交易记录表outTradeNo(商户订单号)字段。

##v1.20.3_0222233
#####1.日结功能
######1.1 新增 当前已经日结后不能继续收银，需要先挂单，等待第二天再手动确认。
######1.2 重构 日结数据库。
#####2.修复 点击发送卡券按钮程序闪退的问题。
#####3.修复 点击发送商品输入商品条码后商品不显示的问题。
#####4.重构 订单模块，更新订单明细数据库，调整订单结算和挂单逻辑。
##v1.20.3_0222232
1.日结功能
1.1 修改毛利率显示为百分比。
1.2 应用启动后自动弹出的日结页面必须确认后才能继续收银操作。
1.3 修复首次加载日结数据闪退的问题。
2.交接班功能
2.1 修复 交接班起始时间不正确的问题。
3.重构订单模块。
##v1.20.2_0222231
1.新增 日结功能。
2.新增 交接班功能。
4.新增 退单确认后需要打开钱箱（退钱给顾客）。
5.修复 快递代收底部信息栏没有显示的问题。
6.小票打印功能。
6.1 修复 字段显示不完整的问题。
6.2 优化 打印小票时间格式由"yyyy-MM-dd HH:mm" 调整为"yyyy-MM-dd HH:mm:ss"。
6.3 优化 调整票据字段格式（对齐方式）。
7.收银功能(重构)。
7.1 新增 订单已经支付过一部分金额或全部金额后，设置订单的支付状态为已支付。如果中途取消支付，不能再添加或删除商品，必须先支付完该订单。
7.2 新增 挂单操作需要将订单状态修改为挂单（PosOrderEntity.ORDER_STATUS_HANGUP）。
7.3 新增 挂单恢复操作需要将订单状态修改处理中（PosOrderEntity.ORDER_STATUS_PROCESS）。
8.支付功能
8.1 新增 混合支付开启/关闭功能。(混合支付功能关闭状态，支付宝/微信支付金额为固定值不能修改；现金支付收取金额不能小于应收金额。)
8.2 新增 微信条码支付功能。
8.3 优化 调整支付页面授权码／银行单号／会员卡芯片号／支付密码样式为密码样式。
8.4 优化 修改支付宝支付时提交信息seller_id字段值为租户id（原来是顾客guid）
9.优化 库存调拨列表按调入/调出显示, 并缓存首页数据。
10.优化 新建收货单有新品建档自动同步商品库。
11.优化 自采商品建档和入库选择供应商调整为可选条件。
##V1.18.3_0127229
1.修复 门店收银订单流水订单编号显示不正确的问题。
2.修复 断网情况下设置页面订单流水加载失败的问题。
3.修复 库存报损数据显示不正确的问题。
4.优化 新建收货单/退货单/调拨单/报损 商品按时间降序排列。
3.优化 门店收银订单流水加载完成后自动选中；下单时间显示精确到秒；显示商品明细单位。
4.优化 打印小票时间精确到秒。
5.优化 统一EditText样式。
6.优化 登录流程。
##V1.18.3_0127228
1.修复 支付宝条码支付验密流程输入参数商户订单号不正确的问题。
2.修复 批次流水订单详情商品数和商品金额显示不正确的问题。
3.修复 衣服洗护订单流水订单编号显示不正确的问题。
4.优化 查询支付宝条码支付结果失败后，如果交易结果不确定，允许收银员继续查询订单支付状态或撤单。
5.优化 切换账号后，清空常用商品.
6.优化 门店收银流水显示支付方式，隐藏客户信息。
7.优化 新建收货单/退货单/调拨单商品数由商品种类数调整为商品总件数。
8.优化 插拔USB数字键盘卡顿问题。(onPause--onDestroy-onCreate--onResume)leaked window com.android.internal.policy.impl.PhoneWindow$DecorView
##V1.18.3_0126227
1.新增 设置页面激活设备功能。
2.修复 采购退货商品金额为0的问题。
3.修复 未登录状态打开应用时出现白屏的问题。
4.优化 自采商品和商品建档允许商品采购数量为0.
5.优化 代收快递明细支持滑动删除功能。
6.优化 代收快递输入手机号查询用户，未找到用户时，清空用户信息。
7.优化 采购收货单支付功能。
##V1.18.3_0123226
1.新增 库存批次流水查看功能。
2.优化 升级个推SDK2.7.0.0
3.优化 使用着色，减少不必要的图片使用。
4.优化 移除冗余无效的资源文件，精简apk大小。
##V1.18.3_0121225
1.新增 按订单编号，租户查询POS订单。
2.修复 支付宝支付失败时订单异常关闭的问题。
##V1.18.3_0121224
1.新增 新建收货单/退货单/调拨单时备注信息。
2.新增 查看POS机订单流水功能。
3.优化 调整部分样式问题。
##V1.18.2_0121223
1.新增 订购商品时弹出数字框，输入订购数量。
2.新增 订货商品列表页面增加箱规。
3.新增 统采/自采供应商支持速记码查询。
4.新增 调拨功能。
5.新增 修改报损商品数量。
6.修复 订单支付方式不正确问题。
7.优化 功能区的图标做调整，命名更清晰，添加调拨功能.
8.优化 当回到收银页面时，保留订货/新建退货单/新建调拨单页面的状态。
9.优化 订货页面加载数据逻辑。
10.优化 用户体验优化。
##V1.17.10_0115222
1.新增 统采供应商功能。
2.修复 退货商品数量不正确的问题。
3.修复 报损商品名称不显示的问题。
4.优化 进入新建收货单和新建退货单自动弹窗提示选择采购单/收货单。
5.优化 部分页面样式调整。
由于时间关系，很多可以优化的地方还没有来得及改，后面会陆续更新，谢谢使用！！！
##V1.17.10_0115221
1.新增 门店收银流水下单时间显示。
2.修复 采购商品库存不正确的问题。
3.修复 购物车商品金额不正确的问题。
4.优化 支付宝条码支付流程。
5.优化 部分页面样式调整。
##V1.17.10_0115220
1.重构 采购/收货/退货功能。
##V1.17.10_0114219
1.优化 切换到流水页面时，自动加载门店收银流水。
##V1.17.10_0114218
1.新增 采购收货时返回首页，收货信息会保存起来，点击服务台采购收货快捷入口，可以快速切换。
2.重构 收银自采商品建档入库功能。
3.重构 新建收货单/退货单搜索商品功能，新品会提示建档。
4.修复 订单流水同步延迟的问题
5.修复 自采商品--新增商品时输入商品数量为0时点击确认后，确认键不可以再被点击。
6.修复 采购退货明细图片不显示的问题。
7.优化 采购页面平台商加载策略。
8.优化 自采商品－非新品时采购价，零售价，采购数量均可编辑，如果有数字，默认光标跳到最后。
9.优化 部分页面样式调整。
##V1.17.10_0113217
1.重构 修改库存商品属性接口"/scGoodsSku/update"改为"invSkuStore/update".
2.新增 新建收货单修改商品采购价功能。
##V1.17.10_0113216
1.新增 自有供应商显示采购商编号，方便门店通过编号查找。
2.新增 交接班打印结算单功能。
3.新增 库存商品按商品名称模糊查询功能。
4.重构 功能区功能按钮做在第一行，可以滑动，不要占用后面的广告资源.
5.重构 采购商品接口。
6.修复 交接班密码显示上一次输入的问题。
7.修复 部分页面搜索商品时清除供应商后未加载商品的问题。
8.修复 客显不能正常显示的问题。
9.优化 统一公司，同一部门员工登录，使用同一份配置信息。
10.优化 采购商品购物车删除指定供应商的所有商品后，同时删除该供应商。
11.优化 商品排序icon显示规则。
12.优化 部分页面样式调整，优化用户体验
##V1.17.10_0111215
1.新增 退货功能，退货成功并打印流水。
2.新增 收银小票上打印商品条码。
3.新增 库存成本页面供应商显示。
4.新增 重构服务台菜单，新增“采购收货”，“采购退货”菜单快捷菜单；去除“返货”功能
5.优化 类目选择增加清除按键。
6.优化 搜索商品输入商品名称时显示键盘。
7.优化 bug修复。
##V1.17.8_0108211
1.新增 私有供应商。
2.新增 库存商品采购功能。
3.新增 采购支持私有供应商和平台供应商查询。
4.优化 商品搜索查询条件。
5.优化 部分样式调整。
##V1.17.8_0107210
1.新增 计重商品无重量信息时，自动弹出输入框，输入重量信息。
2.新增 修改收银页面“服务台”改成“登录账户的租户名称”
3.优化 商品排序功能。
4.新增 库存成本，库存批次，库存盘点，库存报损功能
5.新增 新建退货单页面。
6.优化 数据更新逻辑
7.重构 采购订单接口。
##V1.17.8_0104209
1.新增 计重商品无重量信息时，自动弹出输入框，输入重量信息。
2.新增 修改收银页面“服务台”改成“登录账户的租户名称”
3.优化 商品排序功能。
4.新增 库存成本，库存批次，库存盘点，库存报损功能
5.新增 新建退货单页面。
6.优化 数据更新逻辑
7.重构 采购订单接口。
##V1.17.8_0104208
1.重构 POS信息架构2.0
2.优化 登录页面样式调整。
##V1.17.6_1229206
1.优化 线下销售订单流水同步策略。
2.优化 订货购物车逻辑。
3.修复 自采商品信息显示错误的问题。
4.优化 自采和签收操作，避免连续点击发送两次请求。
##V1.17.4_1228206
1.新增 POS公共类目和私有类目
##V1.17.4_1228205
1.修复 部分页面商品显示错乱的问题。
2.修复 收银应收金额为0时，结算页面没有自动关闭的问题。
3.优化 首页功能菜单调整。
##V1.17.4_1228204
1.新增 库存商品条码显示。
2.新增 商品申请搜索功能
3.修复 在修改库存商品的零售价后在收银页面没有立即同步的问题。
4.优化 UI样式调整。
##V1.17.4_1228203
1.新增 商品采购购物车滑动删除商品功能。
2.新增 进货功能菜单，销售菜单改为流水菜单。
3.新增 库存商品搜索功能。
4.修复 交货订单下拉刷新无效的问题。
5.优化 登录密码支持字母和符号输入。
6.优化 UI样式调整。
##V1.17.4_1224201
1.优化 采购订单优先加载缓存数据显示，同时在后台加载新数据。
2.修复 收银页面，优惠券或者先支付一部分现金导致应收金额发送改变后，没有及时通知页面刷新导致找零金额没有发送变化的问题。
3.优化 优惠券样式调整。
4.新增 订货查询商品支持商品名称，商品条码，类目查询。
5.新增 洗衣功能。
6.优化 自采商品／商品订购功能。
##V1.17.4_1223200
1.修复 订单不能同步问题，实时同步，每次做多同步10条。
##V1.17.4_1223199
1.优化 主题样式调整。
2.优化 打印小票样式调整。
3.优化 收银商品列表自动滚动到第一条逻辑调整。
4.优化 退出账号时要先清空缓存，避免登录其他账号导致数据重叠。
5.修复 部分页面按下数字键盘上的回车键无反应问题。
6.新增 订货模块
7.新增 消息表情素材功能。
8.重构 洗衣服务和商品申请接口。
9.重构 采购商品逻辑，支持库存商品订货，商城订货，订货页面订货三种，共享购物车。
9.升级 友盟自动更新sdk。
##V1.17.2_1221197
1.修复 自采商品失败的问题。
##V1.17.2_1221196
1.新增 收银页面输入条码未找到商品后，直接弹出新增商品窗口。
2.修复 滑动切换到线上订单页面时，已配送Tab显示待配送订单的问题。
##V1.17.2_1218195
1.优化 订单同步策略。
##V1.17.2_1218194
1.新增 收银输入数字＋星号，直接修改商品数量。
2.优化 广告模块。
3.新增 商品配送功能。
##V1.17.2_1218193
1.新增 收银服务－－广告轮播功能。
##V1.17.2_1218192
1.新增 商品中心模块，申请商品，支付。
2.新增 消息模块。
3.新增 报表模块。
4.新增 采购订单/自采商品模块。
5.新增 线下销售/线上订单/代收快递/待寄快递/衣服洗护模块。
6.新增 收银服务－－广告播放。
7.重构 页面框架，调整部分页面样式。
##V1.17.2_1126191
1.新增 前台类目缓存。
##V1.17.2_1126190
1.新增 卡券支付功能。
2.新增 支付页面点击右上角关闭按钮可以选择“继续购物／支付完成。
3.新增 添加商品时若商品数量为0，则认为无效。
4.修复 收银页面按下星号键(*)修改商品数量失败的问题。
5.修改 同步订单金额值为实际收入金额。
6.修改 卡券核销功能放在同步订单里由后台统一完成。
##V1.17.2_1126189
1.新增 库存商品/待送订单/订单流水，下拉刷新功能。
2.//TODO,清空缓存，可能会出现脏数据。
##V1.17.2_1126188
1.新增 无网络时可以切换商品/订单。
##V1.17.2_1126187
1.修复 点击首页左侧tab切换失败的问题。
2.修复 收银页面按下星号键(*)闪退的问题。
3.新增 缓存前台类目首页品数据。
##V1.17.2_1126186
1.新增 缓存前台类目/库存商品类目/待送订单小区。
2.新增 退货功能。
3.新增 滑动切换支付方式。
##V1.17.2_1126180
1.修复 订单丢失问题。应用启动后删除更新时间小于最后一次更新时间的订单。
##V1.17.2_1126179
1.删除挂起菜单表，统一使用订单表，精简数据库。
##V1.17.2_1126178
2.新增 商品计件/记重功能。
3.当前订单交易成功之后，不再去自动加载挂单，挂单由收银员手动选择。
4.新增 设置：串口配置功能
5.重构收银逻辑，删除临时购物车表，使用订单明细表代替临时购物车表
6.新增 箱规功能。
7.修复 商品保存到常用后，在分类里面不显示的问题。
8.优化  数据同步策略，新增同步账号数据。
9.优化常用商品分类,保存到数据库
10.新增 报损功能。
11.新增 无网络时进入服务菜单提示。
12.修改翻页加载数据时最多支持显示5页，每页30条纪录。
13.布局优化，减少GPU绘制.
##V1.17.2_1117167
1. 重构登录逻辑
2. 新增 现金支付时如果找零超过100会弹出提示框，收银员确认是否支付，避免误操作。
3. 新增 交接班功能。
4. 升级个推SDK,解决接收不到推送通知的问题。
##V1.16.4_1110156
1.新增 前台类目功能。
##V1.16.4_1110156
1.优化 小数点后最多输入两位有效数字。
2.新增 快捷键，收银页面按下星号键[*],修改商品数量；结算页面按下星号键[*]，登录会员。
3.优化 收银页面，扫描商品后，商品自动排在最前面。
4.优化 结算完成时，如果有现金支付就打开钱箱，否则不打开钱箱。
5.新增 微信支付功能
6.新增 交接班功能
##v 1.13.6
1. 内存优化
>1 使用更加轻量的数据结构
>2 Enums often require more than twice as much memory as static constants. You should strictly avoid using enums on Android.
2.

1.重构 登录逻辑
2.布局优化
3.内存优化
##V 1.13.4
1. 新增 商品接收功能。